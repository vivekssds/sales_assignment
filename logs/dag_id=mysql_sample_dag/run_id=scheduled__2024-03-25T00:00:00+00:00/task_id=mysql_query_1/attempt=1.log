[2024-03-25T14:52:54.265+0000] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: mysql_sample_dag.mysql_query_1 scheduled__2024-03-25T00:00:00+00:00 [queued]>
[2024-03-25T14:52:54.268+0000] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: mysql_sample_dag.mysql_query_1 scheduled__2024-03-25T00:00:00+00:00 [queued]>
[2024-03-25T14:52:54.268+0000] {taskinstance.py:2171} INFO - Starting attempt 1 of 1
[2024-03-25T14:52:54.274+0000] {taskinstance.py:2192} INFO - Executing <Task(MySqlOperator): mysql_query_1> on 2024-03-25 00:00:00+00:00
[2024-03-25T14:52:54.277+0000] {standard_task_runner.py:60} INFO - Started process 227 to run task
[2024-03-25T14:52:54.279+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'mysql_sample_dag', 'mysql_query_1', 'scheduled__2024-03-25T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/mysqltest.py', '--cfg-path', '/tmp/tmpyx41490u']
[2024-03-25T14:52:54.281+0000] {standard_task_runner.py:88} INFO - Job 2: Subtask mysql_query_1
[2024-03-25T14:52:54.311+0000] {task_command.py:423} INFO - Running <TaskInstance: mysql_sample_dag.mysql_query_1 scheduled__2024-03-25T00:00:00+00:00 [running]> on host 999def8209c6
[2024-03-25T14:52:54.362+0000] {taskinstance.py:2481} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='mysql_sample_dag' AIRFLOW_CTX_TASK_ID='mysql_query_1' AIRFLOW_CTX_EXECUTION_DATE='2024-03-25T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-25T00:00:00+00:00'
[2024-03-25T14:52:54.363+0000] {sql.py:276} INFO - Executing: select * from dbtdb.test
[2024-03-25T14:52:54.364+0000] {connection.py:473} ERROR - Unable to retrieve connection from secrets backend (LocalFilesystemBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/connection.py", line 468, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 316, in get_connection
    if conn_id in self._local_connections:
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 313, in _local_connections
    return load_connections_dict(self.connections_file)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 265, in load_connections_dict
    secrets: dict[str, Any] = _parse_secret_file(file_path)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 162, in _parse_secret_file
    raise AirflowException(
airflow.exceptions.AirflowException: File /opt/secrets/connections.yaml was not found. Check the configuration of your Secrets backend.
[2024-03-25T14:52:54.375+0000] {taskinstance.py:2699} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 277, in execute
    hook = self.get_db_hook()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 188, in get_db_hook
    return self._hook
  File "/usr/local/lib/python3.8/functools.py", line 967, in __get__
    val = self.func(instance)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 150, in _hook
    conn = BaseHook.get_connection(conn_id)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/hooks/base.py", line 82, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/connection.py", line 479, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `mysql_conn` isn't defined
[2024-03-25T14:52:54.377+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=mysql_sample_dag, task_id=mysql_query_1, execution_date=20240325T000000, start_date=20240325T145254, end_date=20240325T145254
[2024-03-25T14:52:54.382+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 2 for task mysql_query_1 (The conn_id `mysql_conn` isn't defined; 227)
[2024-03-25T14:52:54.412+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-25T14:52:54.423+0000] {taskinstance.py:3281} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-03-25T15:04:24.973+0000] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: mysql_sample_dag.mysql_query_1 scheduled__2024-03-25T00:00:00+00:00 [queued]>
[2024-03-25T15:04:24.977+0000] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: mysql_sample_dag.mysql_query_1 scheduled__2024-03-25T00:00:00+00:00 [queued]>
[2024-03-25T15:04:24.977+0000] {taskinstance.py:2171} INFO - Starting attempt 1 of 1
[2024-03-25T15:04:24.982+0000] {taskinstance.py:2192} INFO - Executing <Task(MySqlOperator): mysql_query_1> on 2024-03-25 00:00:00+00:00
[2024-03-25T15:04:24.985+0000] {standard_task_runner.py:60} INFO - Started process 298 to run task
[2024-03-25T15:04:24.988+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'mysql_sample_dag', 'mysql_query_1', 'scheduled__2024-03-25T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/mysqltest.py', '--cfg-path', '/tmp/tmpq_4vl0la']
[2024-03-25T15:04:24.990+0000] {standard_task_runner.py:88} INFO - Job 2: Subtask mysql_query_1
[2024-03-25T15:04:25.017+0000] {task_command.py:423} INFO - Running <TaskInstance: mysql_sample_dag.mysql_query_1 scheduled__2024-03-25T00:00:00+00:00 [running]> on host e5159b5a31c8
[2024-03-25T15:04:25.059+0000] {taskinstance.py:2481} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='mysql_sample_dag' AIRFLOW_CTX_TASK_ID='mysql_query_1' AIRFLOW_CTX_EXECUTION_DATE='2024-03-25T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-25T00:00:00+00:00'
[2024-03-25T15:04:25.060+0000] {sql.py:276} INFO - Executing: select * from dbtdb.test
[2024-03-25T15:04:25.061+0000] {connection.py:473} ERROR - Unable to retrieve connection from secrets backend (LocalFilesystemBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/connection.py", line 468, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 316, in get_connection
    if conn_id in self._local_connections:
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 313, in _local_connections
    return load_connections_dict(self.connections_file)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 265, in load_connections_dict
    secrets: dict[str, Any] = _parse_secret_file(file_path)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 162, in _parse_secret_file
    raise AirflowException(
airflow.exceptions.AirflowException: File /opt/secrets/connections.yaml was not found. Check the configuration of your Secrets backend.
[2024-03-25T15:04:25.067+0000] {base.py:83} INFO - Using connection ID 'mysql_conn' for task execution.
[2024-03-25T15:04:25.068+0000] {connection.py:473} ERROR - Unable to retrieve connection from secrets backend (LocalFilesystemBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/connection.py", line 468, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 316, in get_connection
    if conn_id in self._local_connections:
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 313, in _local_connections
    return load_connections_dict(self.connections_file)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 265, in load_connections_dict
    secrets: dict[str, Any] = _parse_secret_file(file_path)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 162, in _parse_secret_file
    raise AirflowException(
airflow.exceptions.AirflowException: File /opt/secrets/connections.yaml was not found. Check the configuration of your Secrets backend.
[2024-03-25T15:04:25.073+0000] {base.py:83} INFO - Using connection ID 'mysql_conn' for task execution.
[2024-03-25T15:04:25.084+0000] {sql.py:432} INFO - Running statement: select * from dbtdb.test, parameters: None
[2024-03-25T15:04:25.085+0000] {taskinstance.py:2699} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 282, in execute
    output = hook.run(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/hooks/sql.py", line 392, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/hooks/sql.py", line 437, in _run_command
    cur.execute(sql_statement)
  File "/home/airflow/.local/lib/python3.8/site-packages/MySQLdb/cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "/home/airflow/.local/lib/python3.8/site-packages/MySQLdb/cursors.py", line 330, in _query
    db.query(q)
  File "/home/airflow/.local/lib/python3.8/site-packages/MySQLdb/connections.py", line 257, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1146, "Table 'dbtdb.test' doesn't exist")
[2024-03-25T15:04:25.091+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=mysql_sample_dag, task_id=mysql_query_1, execution_date=20240325T000000, start_date=20240325T150424, end_date=20240325T150425
[2024-03-25T15:04:25.096+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 2 for task mysql_query_1 ((1146, "Table 'dbtdb.test' doesn't exist"); 298)
[2024-03-25T15:04:25.120+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-25T15:04:25.130+0000] {taskinstance.py:3281} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-03-25T17:40:21.043+0000] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: mysql_sample_dag.mysql_query_1 scheduled__2024-03-25T00:00:00+00:00 [queued]>
[2024-03-25T17:40:21.048+0000] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: mysql_sample_dag.mysql_query_1 scheduled__2024-03-25T00:00:00+00:00 [queued]>
[2024-03-25T17:40:21.048+0000] {taskinstance.py:2171} INFO - Starting attempt 1 of 1
[2024-03-25T17:40:21.056+0000] {taskinstance.py:2192} INFO - Executing <Task(MySqlOperator): mysql_query_1> on 2024-03-25 00:00:00+00:00
[2024-03-25T17:40:21.061+0000] {standard_task_runner.py:60} INFO - Started process 2879 to run task
[2024-03-25T17:40:21.063+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'mysql_sample_dag', 'mysql_query_1', 'scheduled__2024-03-25T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/mysqltest.py', '--cfg-path', '/tmp/tmpxne7qf_r']
[2024-03-25T17:40:21.066+0000] {standard_task_runner.py:88} INFO - Job 3: Subtask mysql_query_1
[2024-03-25T17:40:21.105+0000] {task_command.py:423} INFO - Running <TaskInstance: mysql_sample_dag.mysql_query_1 scheduled__2024-03-25T00:00:00+00:00 [running]> on host ccbf6eb753ee
[2024-03-25T17:40:21.160+0000] {taskinstance.py:2481} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='mysql_sample_dag' AIRFLOW_CTX_TASK_ID='mysql_query_1' AIRFLOW_CTX_EXECUTION_DATE='2024-03-25T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-25T00:00:00+00:00'
[2024-03-25T17:40:21.162+0000] {sql.py:276} INFO - Executing: select * from dbtdb.test
[2024-03-25T17:40:21.162+0000] {connection.py:473} ERROR - Unable to retrieve connection from secrets backend (LocalFilesystemBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/connection.py", line 468, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 316, in get_connection
    if conn_id in self._local_connections:
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 313, in _local_connections
    return load_connections_dict(self.connections_file)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 265, in load_connections_dict
    secrets: dict[str, Any] = _parse_secret_file(file_path)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 162, in _parse_secret_file
    raise AirflowException(
airflow.exceptions.AirflowException: File /opt/secrets/connections.yaml was not found. Check the configuration of your Secrets backend.
[2024-03-25T17:40:21.169+0000] {base.py:83} INFO - Using connection ID 'mysql_conn' for task execution.
[2024-03-25T17:40:21.171+0000] {connection.py:473} ERROR - Unable to retrieve connection from secrets backend (LocalFilesystemBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/connection.py", line 468, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 316, in get_connection
    if conn_id in self._local_connections:
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 313, in _local_connections
    return load_connections_dict(self.connections_file)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 265, in load_connections_dict
    secrets: dict[str, Any] = _parse_secret_file(file_path)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/secrets/local_filesystem.py", line 162, in _parse_secret_file
    raise AirflowException(
airflow.exceptions.AirflowException: File /opt/secrets/connections.yaml was not found. Check the configuration of your Secrets backend.
[2024-03-25T17:40:21.177+0000] {base.py:83} INFO - Using connection ID 'mysql_conn' for task execution.
[2024-03-25T17:40:21.196+0000] {sql.py:432} INFO - Running statement: select * from dbtdb.test, parameters: None
[2024-03-25T17:40:21.197+0000] {taskinstance.py:2699} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 282, in execute
    output = hook.run(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/hooks/sql.py", line 392, in run
    self._run_command(cur, sql_statement, parameters)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/hooks/sql.py", line 437, in _run_command
    cur.execute(sql_statement)
  File "/home/airflow/.local/lib/python3.8/site-packages/MySQLdb/cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "/home/airflow/.local/lib/python3.8/site-packages/MySQLdb/cursors.py", line 330, in _query
    db.query(q)
  File "/home/airflow/.local/lib/python3.8/site-packages/MySQLdb/connections.py", line 257, in query
    _mysql.connection.query(self, query)
MySQLdb.OperationalError: (1049, "Unknown database 'dbtdb'")
[2024-03-25T17:40:21.204+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=mysql_sample_dag, task_id=mysql_query_1, execution_date=20240325T000000, start_date=20240325T174021, end_date=20240325T174021
[2024-03-25T17:40:21.211+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 3 for task mysql_query_1 ((1049, "Unknown database 'dbtdb'"); 2879)
[2024-03-25T17:40:21.236+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-25T17:40:21.248+0000] {taskinstance.py:3281} INFO - 0 downstream tasks scheduled from follow-on schedule check
